# Migration `20201015145807-migration`

This migration has been generated by A. David Thyresson at 10/15/2020, 10:58:07 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Entry" DROP CONSTRAINT "Entry_entryStreamId_fkey"

ALTER TABLE "public"."Entry" DROP COLUMN "entryStreamId"

CREATE TABLE "public"."ArticleCategory" (
"id" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"articleId" text   NOT NULL ,
"uid" text   NOT NULL ,
"label" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."ArticleSummaries" (
"id" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"articleId" text   NOT NULL ,
"sentenceText" text   NOT NULL ,
"sentenceScore" Decimal(65,30)   NOT NULL DEFAULT 0,
"sentencePosition" integer   NOT NULL DEFAULT 0,
PRIMARY KEY ("id")
)

ALTER TABLE "public"."ArticleCategory" ADD FOREIGN KEY ("articleId")REFERENCES "public"."Article"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."ArticleSummaries" ADD FOREIGN KEY ("articleId")REFERENCES "public"."Article"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201006115203-migration..20201015145807-migration
--- datamodel.dml
+++ datamodel.dml
@@ -1,9 +1,9 @@
 datasource DS {
   // optionally set multiple providers
   // example: provider = ["sqlite", "postgresql"]
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider        = "prisma-client-js"
@@ -16,41 +16,51 @@
   TWEET
 }
 model Entry {
-  id            String       @id @default(cuid())
-  createdAt     DateTime     @default(now())
-  updatedAt     DateTime     @default(now())
-  uid           String       @unique
-  documentType  DocumentType @default(TWEET)
-  document      Json
-  tweet         Tweet?
-  article       Article?
-  entryStream   EntryStream? @relation(fields: [entryStreamId], references: [id])
-  entryStreamId String?
+  id           String       @id @default(cuid())
+  createdAt    DateTime     @default(now())
+  updatedAt    DateTime     @default(now())
+  uid          String       @unique
+  documentType DocumentType @default(TWEET)
+  document     Json
+  tweet        Tweet?
+  article      Article?
 }
 model Article {
-  id             String          @id @default(cuid())
-  createdAt      DateTime        @default(now())
-  updatedAt      DateTime        @default(now())
-  publishedAt    DateTime        @default(now())
-  entry          Entry           @relation(fields: [entryId], references: [id])
-  entryId        String          @unique
-  author         String
-  siteName       String?
-  title          String
-  description    String?
-  articleText    String?
-  language       String?
-  sentiment      Float           @default(0)
-  tagLabels      String[]
-  url            String          @unique
-  articleContext ArticleContext?
-  tags           Tag[]
-  tweets         Tweet[]
+  id                String             @id @default(cuid())
+  createdAt         DateTime           @default(now())
+  updatedAt         DateTime           @default(now())
+  publishedAt       DateTime           @default(now())
+  entry             Entry              @relation(fields: [entryId], references: [id])
+  entryId           String             @unique
+  author            String
+  siteName          String?
+  title             String
+  description       String?
+  articleText       String?
+  language          String?
+  sentiment         Float              @default(0)
+  tagLabels         String[]
+  url               String             @unique
+  articleContext    ArticleContext?
+  tags              Tag[]
+  tweets            Tweet[]
+  articleCategories ArticleCategory[]
+  summaries         ArticleSummaries[]
 }
+model ArticleCategory {
+  id        String   @id @default(cuid())
+  createdAt DateTime @default(now())
+  updatedAt DateTime @default(now())
+  article   Article  @relation(fields: [articleId], references: [id])
+  articleId String
+  uid       String
+  label     String
+}
+
 model ArticleContext {
   id        String   @id @default(cuid())
   createdAt DateTime @default(now())
   updatedAt DateTime @default(now())
@@ -58,8 +68,19 @@
   articleId String
   content   Json
 }
+model ArticleSummaries {
+  id               String   @id @default(cuid())
+  createdAt        DateTime @default(now())
+  updatedAt        DateTime @default(now())
+  article          Article  @relation(fields: [articleId], references: [id])
+  articleId        String
+  sentenceText     String
+  sentenceScore    Float    @default(0)
+  sentencePosition Int      @default(0)
+}
+
 enum StreamSource {
   FEEDLY
 }
@@ -79,9 +100,8 @@
   name             String       @unique
   description      String?
   streamIdentifier String       @unique
   continuation     String?
-  entries          Entry[]
 }
 model Tag {
   id           String       @id @default(cuid())
```


