# Migration `20200916011414-migration`

This migration has been generated by A. David Thyresson at 9/15/2020, 9:14:14 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Entry" (
"id" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"uid" text   NOT NULL ,
"documentType" "DocumentType"  NOT NULL DEFAULT E'TWEET',
"document" jsonb   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Article" (
"id" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"publishedAt" timestamp(3)   NOT NULL ,
"entryId" text   NOT NULL ,
"author" text   NOT NULL ,
"title" text   NOT NULL ,
"url" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."ArticleContext" (
"id" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"articleId" text   NOT NULL ,
"content" jsonb   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Tweet" (
"id" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"publishedAt" timestamp(3)   NOT NULL ,
"entryId" text   NOT NULL ,
"author" text   NOT NULL ,
"title" text   NOT NULL ,
"content" text   NOT NULL ,
"url" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."TweetCategory" (
"id" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"tweetId" text   NOT NULL ,
"uid" text   NOT NULL ,
"label" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."TweetContext" (
"id" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"tweetId" text   NOT NULL ,
"content" jsonb   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."TweetPriority" (
"id" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"tweetId" text   NOT NULL ,
"uid" text   NOT NULL ,
"label" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."TweetPriorityTerm" (
"id" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"tweetPriorityId" text   ,
"uid" text   NOT NULL ,
"label" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE UNIQUE INDEX "Entry.uid_unique" ON "public"."Entry"("uid")

CREATE UNIQUE INDEX "Article.url_unique" ON "public"."Article"("url")

CREATE UNIQUE INDEX "Article_entryId_unique" ON "public"."Article"("entryId")

CREATE UNIQUE INDEX "ArticleContext_articleId_unique" ON "public"."ArticleContext"("articleId")

CREATE UNIQUE INDEX "Tweet.url_unique" ON "public"."Tweet"("url")

CREATE UNIQUE INDEX "Tweet_entryId_unique" ON "public"."Tweet"("entryId")

CREATE UNIQUE INDEX "TweetContext_tweetId_unique" ON "public"."TweetContext"("tweetId")

ALTER TABLE "public"."Article" ADD FOREIGN KEY ("entryId")REFERENCES "public"."Entry"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."ArticleContext" ADD FOREIGN KEY ("articleId")REFERENCES "public"."Article"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Tweet" ADD FOREIGN KEY ("entryId")REFERENCES "public"."Entry"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."TweetCategory" ADD FOREIGN KEY ("tweetId")REFERENCES "public"."Tweet"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."TweetContext" ADD FOREIGN KEY ("tweetId")REFERENCES "public"."Tweet"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."TweetPriority" ADD FOREIGN KEY ("tweetId")REFERENCES "public"."Tweet"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."TweetPriorityTerm" ADD FOREIGN KEY ("tweetPriorityId")REFERENCES "public"."TweetPriority"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200916011414-migration
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,105 @@
+datasource DS {
+  // optionally set multiple providers
+  // example: provider = ["sqlite", "postgresql"]
+  provider = "postgresql"
+  url = "***"
+}
+
+generator client {
+  provider      = "prisma-client-js"
+  binaryTargets = "native"
+}
+
+enum DocumentType {
+  ARTICLE
+  TWEET
+}
+
+model Entry {
+  id           String       @id @default(cuid())
+  createdAt    DateTime     @default(now())
+  updatedAt    DateTime     @default(now())
+  uid          String       @unique
+  documentType DocumentType @default(TWEET)
+  document     Json
+  tweet        Tweet?
+  article      Article?
+}
+
+model Article {
+  id             String         @id @default(cuid())
+  createdAt      DateTime       @default(now())
+  updatedAt      DateTime       @default(now())
+  publishedAt    DateTime
+  entry          Entry          @relation(fields: [entryId], references: [id])
+  entryId        String
+  author         String
+  title          String
+  url            String         @unique
+  articleContext ArticleContext
+}
+
+model ArticleContext {
+  id        String   @id @default(cuid())
+  createdAt DateTime @default(now())
+  updatedAt DateTime @default(now())
+  article   Article  @relation(fields: [articleId], references: [id])
+  articleId String
+  content   Json
+}
+
+model Tweet {
+  id              String          @id @default(cuid())
+  createdAt       DateTime        @default(now())
+  updatedAt       DateTime        @default(now())
+  publishedAt     DateTime
+  entry           Entry           @relation(fields: [entryId], references: [id])
+  entryId         String
+  author          String
+  title           String
+  content         String
+  url             String          @unique
+  tweetContext    TweetContext?
+  tweetCategories TweetCategory[]
+  tweetPriorities TweetPriority[]
+}
+
+model TweetCategory {
+  id        String   @id @default(cuid())
+  createdAt DateTime @default(now())
+  updatedAt DateTime @default(now())
+  tweet     Tweet    @relation(fields: [tweetId], references: [id])
+  tweetId   String
+  uid       String
+  label     String
+}
+
+model TweetContext {
+  id        String   @id @default(cuid())
+  createdAt DateTime @default(now())
+  updatedAt DateTime @default(now())
+  tweet     Tweet    @relation(fields: [tweetId], references: [id])
+  tweetId   String
+  content   Json
+}
+
+model TweetPriority {
+  id                 String              @id @default(cuid())
+  createdAt          DateTime            @default(now())
+  updatedAt          DateTime            @default(now())
+  tweet              Tweet               @relation(fields: [tweetId], references: [id])
+  tweetId            String
+  uid                String
+  label              String
+  tweetPriorityTerms TweetPriorityTerm[]
+}
+
+model TweetPriorityTerm {
+  id              String         @id @default(cuid())
+  createdAt       DateTime       @default(now())
+  updatedAt       DateTime       @default(now())
+  tweetPriority   TweetPriority? @relation(fields: [tweetPriorityId], references: [id])
+  tweetPriorityId String?
+  uid             String
+  label           String
+}
```


